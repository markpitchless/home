#!/bin/sh

#
# Boot strap nfa install by cloning git repo into ~/.nfa
# Back up the old (probably distro default) .bashrc and .bash_profile files.
# Symlink in the nfa versions.
#

user="$USER"

bakdate="$(date +%Y%m%dT%H%M%S)"

sudo apt-get install git ansible

git clone http://github.com/markpitchless/home.git ~/.nfa

cp "/home/$user/.profile" "/home/$user/.profile.$bakdate"
cp "/home/$user/.bashrc" "/home/$user/.bashrc.$bakdate"
cp "/home/$user/.bash_profile" "/home/$user/.bash_profile.$bakdate"
cp "/home/$user/.bash_logout" "/home/$user/.bash_logout.$bakdate"
ln -s .nfa/profile .profile
ln -s .nfa/bashrc .bashrc
ln -s .nfa/bash_profile .bash_profile
ln -s .nfa/bash_logout .bash_logout

cd .nfa
for dot in dot.*; do
    linkname=$(echo "$dot" | sed -e 's/^dot//')
    echo Linking $dot
    ln -s "../$linkname" "$dot"
done

cd
. ~/.bashrc
nfa-provision
